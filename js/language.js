// Language translations
const translations = {
    en: {
        // Header & Navigation
        'portfolio': 'Portfolio',
        'work': 'Work',
        'process': 'Process',
        'skills': 'Skills',
        'testimonials': 'Testimonials',
        'language': 'فارسی',
        'lang_code': 'EN',
        'lang_code_alt': 'فا',

        // Hero Section
        'ui_designer_frontend_developer': 'UI Designer & <br>Frontend Developer',
        'hero_description': 'I create stunning landing pages and hero sections that convert visitors into customers.',
        'see_my_work': 'See My Work',

        // Skills Section
        'skills_tools': 'Skills & Tools',
        'skills_description': 'My technical expertise and the tools I use to bring designs to life.',

        // Process Section
        'my_design_process': 'My Design Process',
        'process_description': 'I follow a systematic approach to deliver exceptional results.',
        'research': 'Research',
        'research_description': 'Understanding your business, target audience, and competition to establish clear goals.',
        'design': 'Design',
        'design_description': 'Creating wireframes and visual designs that align with your brand and conversion goals.',
        'development': 'Development',
        'development_description': 'Translating designs into clean, efficient code that performs flawlessly across devices.',
        'testing': 'Testing',
        'testing_description': 'Ensuring performance, accessibility, and conversion optimization across all user touchpoints.',

        // Testimonials
        'what_clients_say': 'What Clients Say',
        'feedback_from_people': 'Feedback from people I\'ve worked with',
        'testimonial_1': '"The landing page design exceeded our expectations and helped increase our conversion rate by 40%. Professional, creative, and highly recommended!"',
        'testimonial_2': '"Our hero section redesign completely transformed our website\'s performance. The attention to detail and understanding of our brand was impressive."',
        'testimonial_3': '"Working with this team was a game-changer for our startup. The UI design was intuitive and the code implementation was flawless."',
        'sarah_johnson': 'Sarah Johnson',
        'marketing_director': 'Marketing Director, TechStart',
        'michael_rodriguez': 'Michael Rodriguez',
        'ceo': 'CEO, Digital Solutions',
        'emily_chen': 'Emily Chen',
        'founder': 'Founder, NovaTech',

        // Portfolio items
        'ecommerce_platform': 'E-commerce Platform',
        'ecommerce_description': 'Responsive shopping experience with modern UI patterns',
        'healthcare_app': 'Healthcare App',
        'healthcare_description': 'Patient-centered health management interface',
        'travel_experience': 'Travel Experience',
        'travel_description': 'Immersive travel planning and booking platform',
        'music_streaming': 'Music Streaming',
        'music_description': 'Audio-first experience with smart recommendations',
        'productivity_suite': 'Productivity Suite',
        'productivity_description': 'Intuitive tools for organizing work and life',

        // Section indicator
        'home': 'Home',

        // Footer
        'all_rights_reserved': 'All rights reserved.',
        'designed_with_love': 'Designed and developed with'
    }, fa: {
        // Header & Navigation
        'portfolio': 'نمونه کار',
        'work': 'کارها',
        'process': 'فرآیند',
        'skills': 'مهارت‌ها',
        'testimonials': 'نظرات مشتریان',
        'language': 'English',
        'lang_code': 'FA',
        'lang_code_alt': 'EN',

        // Hero Section
        'ui_designer_frontend_developer': 'طراح رابط کاربری و <br>توسعه دهنده فرانت‌اند',
        'hero_description': 'من صفحات فرود و بخش‌های قهرمان خیره‌کننده‌ای ایجاد می‌کنم که بازدیدکنندگان را به مشتریان تبدیل می‌کنند.',
        'see_my_work': 'نمونه کارها',

        // Skills Section
        'skills_tools': 'مهارت‌ها و ابزارها',
        'skills_description': 'تخصص فنی من و ابزارهایی که برای تبدیل طرح‌ها به واقعیت استفاده می‌کنم.',

        // Process Section
        'my_design_process': 'فرآیند طراحی من',
        'process_description': 'من از رویکردی سیستماتیک برای ارائه نتایج استثنایی پیروی می‌کنم.',
        'research': 'تحقیق',
        'research_description': 'درک کسب و کار، مخاطب هدف و رقبای شما برای تعیین اهداف روشن.',
        'design': 'طراحی',
        'design_description': 'ایجاد وایرفریم‌ها و طرح‌های بصری که با برند و اهداف تبدیل شما همسو است.',
        'development': 'توسعه',
        'development_description': 'تبدیل طرح‌ها به کدهای تمیز و کارآمد که در تمام دستگاه‌ها بی‌نقص اجرا می‌شود.',
        'testing': 'آزمایش',
        'testing_description': 'اطمینان از عملکرد، دسترسی‌پذیری و بهینه‌سازی تبدیل در تمام نقاط تماس کاربر.',

        // Testimonials
        'what_clients_say': 'نظرات مشتریان',
        'feedback_from_people': 'بازخورد از افرادی که با آنها کار کرده‌ام',
        'testimonial_1': '"طراحی صفحه فرود فراتر از انتظارات ما بود و باعث افزایش ۴۰٪ نرخ تبدیل ما شد. حرفه‌ای، خلاق و کاملاً قابل توصیه!"',
        'testimonial_2': '"طراحی مجدد بخش اصلی ما عملکرد وبسایت ما را کاملاً متحول کرد. توجه به جزئیات و درک برند ما تحسین‌برانگیز بود."',
        'testimonial_3': '"کار با این تیم برای استارتاپ ما یک تحول اساسی بود. طراحی رابط کاربری بسیار بصری و پیاده‌سازی کد بی‌نقص بود."',
        'sarah_johnson': 'سارا جانسون',
        'marketing_director': 'مدیر بازاریابی، تکنولوژی استارت',
        'michael_rodriguez': 'مایکل رودریگز',
        'ceo': 'مدیرعامل، راهکارهای دیجیتال',
        'emily_chen': 'امیلی چن',
        'founder': 'بنیانگذار، نووا تک',

        // Portfolio items
        'ecommerce_platform': 'پلتفرم تجارت الکترونیک',
        'ecommerce_description': 'تجربه خرید واکنش‌گرا با الگوهای رابط کاربری مدرن',
        'healthcare_app': 'اپلیکیشن سلامت',
        'healthcare_description': 'رابط مدیریت سلامت با محوریت بیمار',
        'travel_experience': 'تجربه سفر',
        'travel_description': 'پلتفرم برنامه‌ریزی و رزرو سفر غوطه‌ور',
        'music_streaming': 'پخش موسیقی',
        'music_description': 'تجربه اولویت صوتی با پیشنهادات هوشمند',
        'productivity_suite': 'مجموعه بهره‌وری',
        'productivity_description': 'ابزارهای بدیهی برای سازماندهی کار و زندگی',

        // Section indicator
        'home': 'خانه',

        // Footer
        'all_rights_reserved': 'تمامی حقوق محفوظ است.',
        'designed_with_love': 'طراحی و توسعه با'
    }
};

// Default language
let currentLanguage = localStorage.getItem('language') || 'en';

// Function to hide the language transition overlay
function hideLanguageOverlay() {
    const overlay = document.querySelector('.language-transition-overlay');
    console.log('Hiding language overlay:', overlay);
    if (overlay) {
        overlay.classList.remove('active');
    }

    // Go to top section to show effects properly, but only if not already there
    // Try different ways to determine if we're at the top section
    try {
        // Method 1: Check script.js's currentSectionIndex
        if (typeof window.currentSectionIndex !== 'undefined' && window.currentSectionIndex !== 0) {
            scrollToTop();
            return;
        }

        // Method 2: Check data attribute on body
        const currentSection = document.body.getAttribute('data-current-section');
        if (currentSection && currentSection !== '0') {
            scrollToTop();
            return;
        }

        // Method 3: Check scroll position
        if (window.scrollY > 10) {
            scrollToTop();
        }
    } catch (e) {
        console.log('Error checking section, scrolling to top anyway:', e);
        scrollToTop();
    }
}

// Helper function to scroll to top
function scrollToTop() {
    const upIndicator = document.querySelector('.up-indicator');
    if (upIndicator) {
        upIndicator.click();
    } else {
        window.scrollTo({top: 0, behavior: 'smooth'});
    }
}

// Function to change language
function changeLanguage(lang) {
    // Show the transition overlay
    const overlay = document.querySelector('.language-transition-overlay');
    console.log('Language change clicked, overlay:', overlay);
    overlay.classList.add('active');

    // Failsafe - force hide overlay after 2 seconds no matter what
    const failsafeTimer = setTimeout(() => {
        console.log('Language failsafe timer triggered');
        hideLanguageOverlay();
    }, 2000);

    setTimeout(() => {
        currentLanguage = lang;
        localStorage.setItem('language', lang);
        updatePageContent();
        updatePageDirection();

        // Hide the overlay after a short delay
        setTimeout(() => {
            clearTimeout(failsafeTimer); // Clear failsafe timer
            hideLanguageOverlay();
        }, 1000);
    }, 1000);
}

// Function to update page direction based on language
function updatePageDirection() {
    document.documentElement.dir = currentLanguage === 'fa' ? 'rtl' : 'ltr';
    document.body.classList.toggle('rtl', currentLanguage === 'fa');
    document.body.classList.toggle('ltr', currentLanguage === 'en');
}

// Function to update content based on current language
function updatePageContent() {
    const elements = document.querySelectorAll('[data-i18n]');

    elements.forEach(element => {
        const key = element.getAttribute('data-i18n');

        if (translations[currentLanguage][key]) {
            if (key.includes('_description') || key === 'ui_designer_frontend_developer') {
                element.innerHTML = translations[currentLanguage][key];
            } else {
                element.textContent = translations[currentLanguage][key];
            }
        }
    });

    // Update language switch buttons
    const langSwitches = document.querySelectorAll('.lang-switch');
    if (langSwitches.length > 0) {
        langSwitches.forEach(switchBtn => {
            const langCode = switchBtn.querySelector('.lang-code');
            const langCodeAlt = switchBtn.querySelector('.lang-code-alt');

            if (langCode) {
                langCode.textContent = translations[currentLanguage]['lang_code'];
            }

            if (langCodeAlt) {
                langCodeAlt.textContent = translations[currentLanguage]['lang_code_alt'];
            }

            if (!langCode && !langCodeAlt) {
                switchBtn.textContent = translations[currentLanguage]['language'];
            }
        });
    }
}

// Initialize language on page load
document.addEventListener('DOMContentLoaded', () => {
    updatePageDirection();
    updatePageContent();
});